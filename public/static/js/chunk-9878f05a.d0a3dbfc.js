(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9878f05a"],{"7db0":function(e,t,a){"use strict";var r=a("23e7"),n=a("b727").find,s=a("44d2"),i=a("ae40"),l="find",o=!0,c=i(l);l in[]&&Array(1)[l]((function(){o=!1})),r({target:"Array",proto:!0,forced:o||!c},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),s(l)},b768:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"f-c"},[a("el-alert",{attrs:{title:"用户管理中心",type:"success",closable:!1}}),a("div",{staticClass:"header w-100 f-r j-e m-tb-10"},[a("el-input",{staticClass:"input-with-select w-30 m-r-20",attrs:{placeholder:"输入关键词搜索用户"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.query.search,callback:function(t){e.$set(e.query,"search",t)},expression:"query.search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1),a("el-button",{staticClass:"m-r-40",attrs:{type:"primary"},on:{click:e.openDialog}},[e._v("添加用户")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"avatar",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("el-image",{staticClass:"w-60-px",attrs:{src:t.avatar,"preview-src-list":[t.avatar]}})]}}])}),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),a("el-table-column",{attrs:{prop:"password",label:"密码"}}),a("el-table-column",{attrs:{prop:"name",label:"用户名"}}),a("el-table-column",{attrs:{prop:"age",label:"年龄"}}),a("el-table-column",{attrs:{prop:"sex",label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.sex?a("el-tag",{attrs:{type:"primary"}},[e._v("男")]):a("el-tag",{attrs:{type:"danger"}},[e._v("女")])]}}])}),a("el-table-column",{attrs:{prop:"createDate",label:"注册时间"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.dayjs(a.createDate).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleTableEdit(t.$index,t.row)}}},[e._v("编辑 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleTableDelete(t.$index,t.row)}}},[e._v("删除 ")])]}}])})],1),a("el-pagination",{staticClass:"m-t-20",attrs:{background:"","current-page":e.query.page,"page-sizes":[5,10,15,20],"page-size":e.query.size,layout:"sizes, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){return e.$set(e.query,"page",t)},"update:current-page":function(t){return e.$set(e.query,"page",t)},"size-change":e.changeSize,"current-change":e.changePage}}),a("el-dialog",{attrs:{title:e.isEdit?"编辑用户":"添加用户",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"dialogForm",staticStyle:{width:"100%"},attrs:{"label-position":"left","label-width":"100px",model:e.currentRow,rules:e.rule}},[a("el-form-item",{attrs:{label:"用户名",prop:"name"}},[a("el-input",{model:{value:e.currentRow.name,callback:function(t){e.$set(e.currentRow,"name",t)},expression:"currentRow.name"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.currentRow.email,callback:function(t){e.$set(e.currentRow,"email",t)},expression:"currentRow.email"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{model:{value:e.currentRow.password,callback:function(t){e.$set(e.currentRow,"password",t)},expression:"currentRow.password"}})],1),e.isEdit?a("el-form-item",{attrs:{label:"性别",prop:"sex"}},[a("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择"},model:{value:e.currentRow.sex,callback:function(t){e.$set(e.currentRow,"sex",t)},expression:"currentRow.sex"}},e._l([{label:"男",value:1},{label:"女",value:0}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)],1):e._e(),e.isEdit?a("el-form-item",{attrs:{label:"年龄",prop:"age"}},[a("el-input",{attrs:{type:"number"},model:{value:e.currentRow.age,callback:function(t){e.$set(e.currentRow,"age",t)},expression:"currentRow.age"}})],1):e._e(),e.isEdit?a("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[a("div",{staticStyle:{display:"flex","justify-content":"start"}},[a("el-button",{attrs:{loading:e.uploadLoading,type:""}},[a("label",{attrs:{for:"avatarFile"}},[e._v("上传头像"),a("i",{staticClass:"el-icon-upload el-icon--right"})])]),e.currentRow.avatar?a("el-image",{staticClass:"m-l-20",staticStyle:{width:"50px",height:"50px"},attrs:{src:e.currentRow.avatar,"preview-src-list":[e.currentRow.avatar]}}):e._e()],1)]):e._e()],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(){e.dialogVisible=!1,e.$refs.dialogForm.resetFields()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确 定")])],1)],1),a("input",{attrs:{id:"avatarFile",type:"file",hidden:"hidden"},on:{change:e.upload}})],1)},n=[],s=a("c7eb"),i=a("1da1"),l=(a("ac1f"),a("00b4"),a("e9c4"),a("b0c0"),a("d3b7"),a("c24f")),o=a("c08d"),c=function(e,t,a){t.length<6?a(new Error("密码不能少于六位")):a()},u=function(e,t,a){t<10||t>100?a(new Error("年龄需要大于10岁小于100岁")):a()},d=function(e,t,a){var r=/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;r.test(t)?a():a(new Error("请填写正确格式邮箱"))},p={name:"CommonPage",data:function(){return{tableData:[],total:0,query:{page:1,size:5,search:""},rule:{name:[{required:!0,trigger:"blur",message:"请填写用户名"}],age:[{required:!0,trigger:"blur",validator:u}],email:[{required:!0,trigger:"blur",message:"请填写邮箱"},{required:!0,trigger:"blur",validator:d}],password:[{required:!0,trigger:"blur",message:"请填写密码"},{trigger:"blur",validator:c}]},isEdit:!1,dialogVisible:!1,currentRow:{},curd:{insert:l["c"],delete:l["a"],update:l["e"],query:l["b"]},uploadLoading:!1}},computed:{},mounted:function(){this.getList()},methods:{getList:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var a,r,n,i;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.curd.query(e.query);case 2:a=t.sent,r=a.data,n=r.list,i=r.count,e.tableData=n,e.total=i;case 8:case"end":return t.stop()}}),t)})))()},changePage:function(e){this.query.page=e,this.getList()},changeSize:function(e){this.query.size=e,this.getList()},search:function(){this.query.page=1,this.getList()},handleTableEdit:function(e,t){var a=this;return Object(i["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:a.isEdit=!0,a.currentRow=JSON.parse(JSON.stringify(t)),a.dialogVisible=!0;case 3:case"end":return e.stop()}}),e)})))()},handleTableDelete:function(e,t){var a=this;return Object(i["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:a.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.curd.delete(t);case 2:return 1===a.tableData.length&&1!==a.query.page&&(a.query.page=a.query.page-1),e.next=5,a.getList();case 5:a.$message({type:"success",message:"删除成功!"});case 6:case"end":return e.stop()}}),e)})))).catch((function(){a.$message({type:"info",message:"已取消删除"})}));case 1:case"end":return e.stop()}}),e)})))()},openDialog:function(){this.currentRow={name:"",email:"",password:""},this.isEdit=!1,this.dialogVisible=!0},handleClose:function(e){e(),this.$refs.dialogForm.resetFields()},confirmDialog:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.dialogForm.validate();case 2:if(!e.isEdit){t.next=8;break}return t.next=5,e.curd.update(e.currentRow);case 5:e.$message.success("修改成功"),t.next=11;break;case 8:return t.next=10,e.curd.insert({name:e.currentRow.name,email:e.currentRow.email,password:e.currentRow.password});case 10:e.$message.success("添加成功");case 11:return e.dialogVisible=!1,t.next=14,e.getList();case 14:e.$refs.dialogForm.resetFields();case 15:case"end":return t.stop()}}),t)})))()},upload:function(e){var t=this,a=e.target.files,r=a[0];r&&(o["a"].isImage(r.name)?(this.uploadLoading=!0,this.cos(r).then((function(e){t.currentRow["avatar"]="https://"+e.Location,console.log(t.currentRow),t.$message.success("上传成功")}),(function(e){console.log(e),t.$message.error("网络错误上传失败")})).finally((function(){t.uploadLoading=!1}))):this.$message.error("请上传图片格式文件"))}}},f=p,g=a("2877"),b=Object(g["a"])(f,r,n,!1,null,"102ea6c8",null);t["default"]=b.exports},c08d:function(e,t,a){"use strict";a("7db0"),a("d3b7");t["a"]={isImage:function(e){var t=e.split(".").reverse()[0].toLowerCase(),a=!1,r=["png","jpg","jpeg","bmp","gif"];return a=r.find((function(e){return e===t})),a},isLyric:function(e){var t=e.split(".").reverse()[0].toLowerCase(),a=!1,r=["txt","lrc"];return a=r.find((function(e){return e===t})),a},isMusic:function(e){var t=e.split(".").reverse()[0].toLowerCase(),a=!1,r=["mp3","wav","wmv","flac"];return a=r.find((function(e){return e===t})),a}}}}]);