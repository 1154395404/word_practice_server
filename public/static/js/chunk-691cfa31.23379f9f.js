(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-691cfa31"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},5185:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"f-c"},[r("el-alert",{attrs:{title:"单词书管理中心",type:"success",closable:!1}}),r("div",{staticClass:"header w-100 f-r j-e m-tb-10"},[r("Category",{staticClass:"m-r-20",attrs:{"is-have-all":!0},on:{change:e.changeQuery}}),r("el-input",{staticClass:"input-with-select w-30 m-r-20",attrs:{placeholder:"搜索单词书"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.query.search,callback:function(t){e.$set(e.query,"search",t)},expression:"query.search"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1),r("el-button",{staticClass:"m-r-40",attrs:{type:"primary"},on:{click:e.openDialog}},[e._v("添加单词书")])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.getListLoading,expression:"getListLoading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"数据加载中",data:e.tableData,border:""}},[r("el-table-column",{attrs:{prop:"cover",label:"封面图"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[r("el-image",{staticClass:"w-60-px",attrs:{src:t.cover,"preview-src-list":[t.cover]}})]}}])}),r("el-table-column",{attrs:{prop:"name",label:"单词书名"}}),r("el-table-column",{attrs:{width:"180",prop:"createDate",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(e.dayjs(r.createDate).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),r("el-table-column",{attrs:{prop:"word",label:"单词文本"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.lookLyric(n.word)}}},[e._v("查看单词")])]}}])}),r("el-table-column",{attrs:{label:"所属分类"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("el-tag",[e._v(e._s(e.getCategory(n).label||""))])]}}])}),r("el-table-column",{attrs:{label:"描述"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.desc||"无描述")+" ")]}}])}),r("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.handleTableEdit(t.$index,t.row)}}},[e._v("编辑 ")]),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.handleTableDelete(t.$index,t.row)}}},[e._v("删除 ")])]}}])})],1),r("el-pagination",{staticClass:"m-t-20",attrs:{background:"","current-page":e.query.page,"page-sizes":[5,10,15,20],"page-size":e.query.size,layout:"sizes, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){return e.$set(e.query,"page",t)},"update:current-page":function(t){return e.$set(e.query,"page",t)},"size-change":e.changeSize,"current-change":e.changePage}}),r("el-dialog",{attrs:{title:e.isEdit?"编辑单词书信息":"添加单词书信息",visible:e.dialogVisible,width:"600px","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("div",[r("el-form",{ref:"dialogForm",staticStyle:{width:"100%"},attrs:{"label-position":"left","label-width":"100px",model:e.currentRow,rules:e.rule}},[r("el-form-item",{attrs:{label:"单词书名称",prop:"name"}},[r("el-input",{model:{value:e.currentRow.name,callback:function(t){e.$set(e.currentRow,"name",t)},expression:"currentRow.name"}})],1),r("el-form-item",{attrs:{label:"所属分类",prop:"categoryId"}},[r("Category",{staticClass:"w-100",attrs:{value:e.currentRow.categoryId},on:{change:e.changeCurrentCategory}})],1),r("el-form-item",{attrs:{label:"单词",prop:"word"}},[r("div",{staticStyle:{display:"flex","justify-content":"start"}}),r("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请复制或输入单词内容以回车隔开"},model:{value:e.currentRow.word,callback:function(t){e.$set(e.currentRow,"word",t)},expression:"currentRow.word"}})],1),r("el-form-item",{attrs:{label:"单词书描述",prop:"desc"}},[r("div",{staticStyle:{display:"flex","justify-content":"start"}}),r("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入单词书描述"},model:{value:e.currentRow.desc,callback:function(t){e.$set(e.currentRow,"desc",t)},expression:"currentRow.desc"}})],1),r("el-form-item",{attrs:{label:"单词书封面",prop:"cover"}},[r("div",{staticStyle:{display:"flex","justify-content":"start"}},[r("el-button",{attrs:{loading:e.uploadLoading.cover,type:""}},[r("label",{attrs:{for:"cover"}},[e._v("上传单词书封面"),r("i",{staticClass:"el-icon-upload el-icon--right"})])]),e.currentRow.cover?r("el-image",{staticClass:"m-l-20",staticStyle:{width:"50px",height:"50px"},attrs:{src:e.currentRow.cover,"preview-src-list":[e.currentRow.cover]}}):e._e()],1)])],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(){e.dialogVisible=!1,e.$refs.dialogForm.resetFields()}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确 定")])],1)]),r("el-dialog",{attrs:{title:"单词查看",visible:e.dialogLyricVisible,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogLyricVisible=t}}},[r("el-input",{staticClass:"lyricInputDisplay",attrs:{disabled:"",row:20,type:"textarea"},model:{value:e.lyric,callback:function(t){e.lyric=t},expression:"lyric"}}),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogLyricVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogLyricVisible=!1}}},[e._v("确 定")])],1)],1),r("input",{attrs:{id:"cover",type:"file",hidden:"hidden"},on:{change:function(t){return e.upload("cover",t)}}})],1)},a=[],i=r("c7eb"),o=r("1da1"),c=(r("7db0"),r("d3b7"),r("d81d"),r("b0c0"),r("ac1f"),r("841c"),r("e9c4"),r("159b"),r("b775"));function s(e){return Object(c["a"])("/book/query","get",e)}function l(e){return Object(c["a"])("/book/update","post",e)}function u(e){return Object(c["a"])("/book/delete","post",e)}function d(e){return Object(c["a"])("/book/insert","post",e)}var f=r("c405"),p=(r("ca41"),r("c08d")),g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-select",{staticClass:"w-100",attrs:{placeholder:"请选择单词书分类"},on:{change:e.changeHandle},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)},b=[],v={name:"Category",props:{value:{type:String,default:""},isHaveAll:{type:Boolean,default:!1}},data:function(){return{options:[{value:"选项1",label:"黄金糕"},{value:"选项2",label:"双皮奶"},{value:"选项3",label:"蚵仔煎"},{value:"选项4",label:"龙须面"},{value:"选项5",label:"北京烤鸭"}]}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var r,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(f["c"])({page:1,size:1e8});case 2:r=t.sent,n=r.data,e.options=n.list.map((function(e){return{label:e.name,value:e._id}})),e.isHaveAll&&e.options.unshift({label:"全部分类",value:""});case 6:case"end":return t.stop()}}),t)})))()},changeHandle:function(e){this.$emit("change",e)}}},h=v,y=r("2877"),m=Object(y["a"])(h,g,b,!1,null,"0a54c683",null),w=m.exports,x={name:"BookPage",components:{Category:w},data:function(){return{rule:{name:[{required:!0,trigger:"blur",message:"请填写单词书名称"}],categoryId:[{required:!0,trigger:"blur",message:"请选择单词书分类"}]},tableData:[],total:0,query:{page:1,size:5,search:""},isEdit:!1,dialogVisible:!1,currentRow:{name:"",cover:null,categoryId:"",word:"",desc:""},curd:{insert:d,delete:u,update:l,query:s},uploadLoading:{cover:!1,sing:!1,lyric:!1},dialogLyricVisible:!1,lyric:"",isImportSortMode:!1,getListLoading:!1,options:[]}},computed:{},mounted:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getCategoryData();case 2:return t.next=4,e.getList();case 4:e.$route.query.isImport&&(e.isImportSortMode=!0);case 5:case"end":return t.stop()}}),t)})))()},methods:{getCategory:function(e){return this.options.find((function(t){return t.value===e.categoryId}))},getCategoryData:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var r,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(f["c"])({page:1,size:1e8});case 2:r=t.sent,n=r.data,e.options=n.list.map((function(e){return{label:e.name,value:e._id}}));case 5:case"end":return t.stop()}}),t)})))()},changeCurrentCategory:function(e){this.currentRow.categoryId=e},changeQuery:function(e){this.query.search=e,this.getList()},getList:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var r,n,a,o;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.getListLoading=!0,t.next=3,e.curd.query(e.query);case 3:r=t.sent,n=r.data,a=n.list,o=n.count,e.getListLoading=!1,e.tableData=a,e.total=o;case 10:case"end":return t.stop()}}),t)})))()},changePage:function(e){this.query.page=e,this.getList()},changeSize:function(e){this.query.size=e,this.getList()},search:function(){this.query.page=1,this.getList()},handleTableEdit:function(e,t){var r=this;return Object(o["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r.isEdit=!0,r.currentRow=JSON.parse(JSON.stringify(t)),r.dialogVisible=!0;case 3:case"end":return e.stop()}}),e)})))()},handleTableDelete:function(e,t){var r=this;return Object(o["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r.$confirm("此操作将永久删除该单词书信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.curd.delete(t);case 2:return 1===r.tableData.length&&1!==r.query.page&&(r.query.page=r.query.page-1),e.next=5,r.getList();case 5:r.$message({type:"success",message:"删除成功!"});case 6:case"end":return e.stop()}}),e)})))).catch((function(){r.$message({type:"info",message:"已取消删除"})}));case 1:case"end":return e.stop()}}),e)})))()},openDialog:function(){this.resetCurrentRow(),this.isEdit=!1,this.dialogVisible=!0},handleClose:function(e){e(),this.$refs.dialogForm.resetFields()},confirmDialog:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.dialogForm.validate();case 2:if(!e.isEdit){t.next=8;break}return t.next=5,e.curd.update(e.currentRow);case 5:e.$message.success("单词书信息修改成功"),t.next=12;break;case 8:return e.currentRow.cover||delete e.currentRow.cover,t.next=11,e.curd.insert(e.currentRow);case 11:e.$message.success("已添加一本单词书信息进入数据库");case 12:return e.dialogVisible=!1,t.next=15,e.getList();case 15:e.$refs.dialogForm.resetFields();case 16:case"end":return t.stop()}}),t)})))()},upload:function(e,t){var r=this,n=t.target.files,a=n[0];a&&(p["a"].isImage(a.name)||"cover"!==e?(this.uploadLoading[e]=!0,this.cos(a).then((function(t){r.currentRow[e]="https://"+t.Location,console.log(r.currentRow),r.$message.success("上传成功")}),(function(e){console.log(e),r.$message.error("网络错误上传失败")})).finally((function(){r.uploadLoading[e]=!1}))):this.$message.error("请上传图片格式文件"))},play:function(e){document.querySelectorAll("audio").forEach((function(t){e.target!==t&&t.pause()}))},resetCurrentRow:function(){this.currentRow={name:"",cover:null,categoryId:"",word:"",desc:""}},lookLyric:function(e){this.dialogLyricVisible=!0,this.lyric=e}}},k=x,j=(r("e52d"),Object(y["a"])(k,n,a,!1,null,"16554b85",null));t["default"]=j.exports},"7db0":function(e,t,r){"use strict";var n=r("23e7"),a=r("b727").find,i=r("44d2"),o=r("ae40"),c="find",s=!0,l=o(c);c in[]&&Array(1)[c]((function(){s=!1})),n({target:"Array",proto:!0,forced:s||!l},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),i(c)},"841c":function(e,t,r){"use strict";var n=r("d784"),a=r("825a"),i=r("1d80"),o=r("129f"),c=r("14c3");n("search",1,(function(e,t,r){return[function(t){var r=i(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n=r(t,e,this);if(n.done)return n.value;var i=a(e),s=String(this),l=i.lastIndex;o(l,0)||(i.lastIndex=0);var u=c(i,s);return o(i.lastIndex,l)||(i.lastIndex=l),null===u?-1:u.index}]}))},c08d:function(e,t,r){"use strict";r("7db0"),r("d3b7");t["a"]={isImage:function(e){var t=e.split(".").reverse()[0].toLowerCase(),r=!1,n=["png","jpg","jpeg","bmp","gif"];return r=n.find((function(e){return e===t})),r},isLyric:function(e){var t=e.split(".").reverse()[0].toLowerCase(),r=!1,n=["txt","lrc"];return r=n.find((function(e){return e===t})),r},isMusic:function(e){var t=e.split(".").reverse()[0].toLowerCase(),r=!1,n=["mp3","wav","wmv","flac"];return r=n.find((function(e){return e===t})),r}}},c405:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return c}));var n=r("b775");function a(e){return Object(n["a"])("/bookCategory/query","get",e)}function i(e){return Object(n["a"])("/bookCategory/update","post",e)}function o(e){return Object(n["a"])("/bookCategory/delete","post",e)}function c(e){return Object(n["a"])("/bookCategory/insert","post",e)}},ca41:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return o}));var n=r("b775");function a(e){return Object(n["a"])("/activity/queryBanner","get",e)}function i(e){return Object(n["a"])("/activity/getCloudBanner","get",e)}function o(e){return Object(n["a"])("/activity/update","post",e)}},e52d:function(e,t,r){"use strict";r("f011")},f011:function(e,t,r){}}]);